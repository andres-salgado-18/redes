#### Ejercicio 9

Notación para el ejercicio
- H: 192.168.1.104
- H1: 192.168.1.247
- H2: 200.42.33.121
- H3: 173.194.42.245

Omito los puertos, pero están especificados en la tabla

1. H1 envía `SYN` a H, para establecer conexión
2. H hace un GET a H2, una petición HTTP (recordar que es por puerto 80)
3. H3 envía paquete de datos a H1, por la conexión ya establecida
4. H responde la petición de conexión con `SYN|ACK`
5. H1 envía a H el `ACK` final de la conexión, la conexión queda establecida
6. H2 envía paquete de datos a H1, por la conexión ya establecida
7. H2 envía OK de HTTP a H
8. H3 envía `FIN|ACK` a H
9. H responde con `ACK` a H3

**a)**
- De 3, 8 y 9 notamos que H3:443 y H:45911, luego al recibir H:45911 el ACK pasará a `CLOSE_WAIT`
- De 2, 6 y 7 notamos que la conexión sigue en estado `ESTABLISHED`
- De 1,4 y 5, como H:7777 estaba en listen y el primer paquete va desde H1:27351 a H:7777 y el 3-way handshake se completa, esta conexión también queda en estado `ESTABLISHED`
- Por último la conexión de H:34688 que estaba en `TIME-WAIT` es muy probable que haya terminado así que ya no aparecerá en `netstat`
```
Proto Local Address        Foreign Address        State
tcp   0.0.0.0:7777         0.0.0.0:*              LISTEN
tcp   192.168.1.104:7777   192.168.1.247:27351  ESTABLISHED
tcp   192.168.1.104:48600  200.42.33.121:80     ESTABLISHED
tcp   192.168.1.104:45911  173.194.42.245:443   CLOSE_WAIT

```

**b)**
Puede justo después del paquete 4, ver ej 4

